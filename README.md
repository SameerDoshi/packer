# packer
Basics of packer

## Goals
1. Setup Packer
2. Create a customized Linux image from a base image
3. Create a customized Windows image from a base image
4. Create images directly in Azure as a ManagedImage

## Required Software
1. [Visual Studio Code](https://code.visualstudio.com/download)

## Setup
* Download [packer](https://www.packer.io/downloads.html) executable
* Extract packer.exe to a known loaction (ex: C:\src)
* Add C:\src to PATH
* Open a new terminal and run packer (you should see a list of available commands)

## Repo organization
### v1
Ubuntu.json and Windows.json are both hardcoded to produce an image in Azure that has had a few commands run on it

### v2 
both tempaltes moves hardcoding into a variable

### v3
Adds a command to copy files\sample.txt to the /var/tmp and C:\tmp of resulting image

### v4
Includes a VMWare provisioner to provision to VMWare and Azure in parallell


# Quick guide to packer
Packer allows you to build images from code.

Packer uses template files.  The files are templates- their contetents is replaced on the fly by variables that can be passed in (see subscription id), or are autogenerated (See isotimestamp in imagename).

Packer uses builders to build images.  Builders are suplied by vendors and have specific requiremetns.  The Azure builder, for example, requires a client_id, client_secret, etc.  The VMWare builder requires only a source image but supports additional parameters.

Packer uses provisioners to shape the imate.  The provisioners used in this example are all commands that execute on the vm and preform actions.   

## Referemces
* [Create Windows Images in Azure](https://docs.microsoft.com/en-us/azure/virtual-machines/linux/build-image-with-packer)
* [Creating a VMWare image from stratch](https://www.greenreedtech.com/building-vsphere-templates-from-scratch-using-packer-and-the-vsphere-api/)
* [Packer Azure Builders](https://www.packer.io/docs/builders/azure.html)
* [Packer VMWare Builders](https://www.packer.io/docs/builders/vmware.html)
